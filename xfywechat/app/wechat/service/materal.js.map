{"version":3,"sources":["../../../src/wechat/service/materal.js"],"names":["wechatApi","require","_","Materal","prototype","imgList","next","query","options","offset","pageNum","count","pageSize","loadMaterial","data","backdata","dataList","item","totalPages","item_count","totalRows","total_count","isSuccess","body","JSON","stringify","api","newsList","type","forEach","o","article","media_id","update_time","create_time","content","articles","news_item","push","module","exports"],"mappings":"AAAA;;;AAGA;;AAEA;;;;;;;;AACA,IAAIA,YAAYC,QAAQ,cAAR,EAAwBD,SAAxC;AACA,IAAIE,IAAID,QAAQ,QAAR,CAAR;AACA,IAAIE,UAAU,SAAVA,OAAU,GAAU,CAEvB,CAFD;;AAIAA,QAAQC,SAAR,CAAkBC,OAAlB,2CAA2B,iBAAUC,IAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AACnBC,yBADmB,GACX,KAAKA,KADM;AAEnBC,2BAFmB,GAET;AACVC,gCAAOF,MAAMG,OADH;AAEVC,+BAAMJ,MAAMK;AAFF,qBAFS;AAAA;AAAA,2BAMNZ,UAAUa,YAAV,CAAuBL,OAAvB,CANM;;AAAA;AAMnBM,wBANmB;AAOnBC,4BAPmB,GAOR;AACXD,8BAAK;AACDE,sCAASF,KAAKG,IADb;AAEDC,wCAAWJ,KAAKK,UAFf;AAGDC,uCAAUN,KAAKO;AAHd,yBADM;AAMXC,mCAAU;AANC,qBAPQ;;AAevB,yBAAKC,IAAL,GAAYC,KAAKC,SAAL,CAAeV,QAAf,CAAZ;AACA,yBAAKW,GAAL,GAAW,IAAX;AAhBuB;AAAA,2BAiBjBpB,IAjBiB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAA3B;AAmBAH,QAAQC,SAAR,CAAkBuB,QAAlB,2CAA6B,kBAAUrB,IAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AACrBC,yBADqB,GACb,KAAKA,KADQ;AAErBC,2BAFqB,GAEX;AACVoB,8BAAK,MADK;AAEVnB,gCAAOF,MAAMG,OAFH;AAGVC,+BAAMJ,MAAMK;AAHF,qBAFW;AAAA;AAAA,2BAORZ,UAAUa,YAAV,CAAuBL,OAAvB,CAPQ;;AAAA;AAOrBM,wBAPqB;AAQrBC,4BARqB,GAQV;AACXD,8BAAK;AACDE,sCAAS,EADR;AAEDE,wCAAWJ,KAAKK,UAFf;AAGDC,uCAAUN,KAAKO;;AAHd,yBADM;AAOXC,mCAAU;AAPC,qBARU;;AAiBzBpB,sBAAE2B,OAAF,CAAUf,KAAKG,IAAf,EAAoB,UAAUa,CAAV,EAAa;AAC7B,4BAAIC,UAAU;AACVC,sCAASF,EAAEE,QADD;AAEVC,yCAAaH,EAAEG,WAFL;AAGVC,yCAAYJ,EAAEK,OAAF,CAAUD,WAHZ;AAIVE,sCAASN,EAAEK,OAAF,CAAUE;AAJT,yBAAd;AAMAtB,iCAASD,IAAT,CAAcE,QAAd,CAAuBsB,IAAvB,CAA4BP,OAA5B;AACH,qBARD;AASA,yBAAKR,IAAL,GAAYC,KAAKC,SAAL,CAAeV,QAAf,CAAZ;AACA,yBAAKW,GAAL,GAAW,IAAX;AA3ByB;AAAA,2BA4BnBpB,IA5BmB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAA7B;AA8BAiC,OAAOC,OAAP,GAAiB,IAAIrC,OAAJ,EAAjB","file":"materal.js","sourcesContent":["/**\n * Created by yao on 2016/11/20.\n */\n/* global exports */\n\n\"use strict\";\nvar wechatApi = require('../../weixin').wechatApi;\nvar _ = require('lodash');\nvar Materal = function(){\n\n};\n\nMateral.prototype.imgList =function*(next) {\n    var query = this.query;\n    var options = {\n        offset:query.pageNum,\n        count:query.pageSize\n    };\n    var data = yield wechatApi.loadMaterial(options);\n    var backdata = {\n        data:{\n            dataList:data.item,\n            totalPages:data.item_count,\n            totalRows:data.total_count\n        },\n        isSuccess:true\n    };\n    this.body = JSON.stringify(backdata);\n    this.api = true;\n    yield next;\n};\nMateral.prototype.newsList = function*(next){\n    var query = this.query;\n    var options = {\n        type:'news',\n        offset:query.pageNum,\n        count:query.pageSize\n    };\n    var data = yield wechatApi.loadMaterial(options);\n    var backdata = {\n        data:{\n            dataList:[],\n            totalPages:data.item_count,\n            totalRows:data.total_count,\n\n        },\n        isSuccess:true\n    };\n    _.forEach(data.item,function (o) {\n        var article = {\n            media_id:o.media_id,\n            update_time :o.update_time,\n            create_time:o.content.create_time,\n            articles:o.content.news_item\n        };\n        backdata.data.dataList.push(article);\n    });\n    this.body = JSON.stringify(backdata);\n    this.api = true;\n    yield next;\n};\nmodule.exports = new Materal();"]}