{"version":3,"sources":["../../../src/wechat/service/materal.js"],"names":["wechatApi","require","_","Materal","prototype","imgList","next","query","options","offset","pageNum","count","pageSize","loadMaterial","data","backdata","dataList","item","totalPages","item_count","totalRows","total_count","isSuccess","body","JSON","stringify","api","newsList","type","forEach","o","article","media_id","update_time","create_time","content","articles","news_item","push","module","exports"],"mappings":"AAAA;;;AAGA;;AAEA;;;;;;;;AACA,IAAIA,YAAYC,QAAQ,cAAR,EAAwBD,SAAxC;AACA,IAAIE,IAAID,QAAQ,QAAR,CAAR;AACA,IAAIE,UAAU,SAAVA,OAAU,GAAU,CAEvB,CAFD;;AAIAA,QAAQC,SAAR,CAAkBC,OAAlB,8BAA2B,iBAAUC,IAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AACnBC,yBADmB,GACX,KAAKA,KADM;AAEnBC,2BAFmB,GAET;AACVC,gCAAOF,MAAMG,OADH;AAEVC,+BAAMJ,MAAMK;AAFF,qBAFS;AAAA;AAAA,2BAMNZ,UAAUa,YAAV,CAAuBL,OAAvB,CANM;;AAAA;AAMnBM,wBANmB;AAOnBC,4BAPmB,GAOR;AACXD,8BAAK;AACDE,sCAASF,KAAKG,IADb;AAEDC,wCAAWJ,KAAKK,UAFf;AAGDC,uCAAUN,KAAKO;AAHd,yBADM;AAMXC,mCAAU;AANC,qBAPQ;;AAevB,yBAAKC,IAAL,GAAYC,KAAKC,SAAL,CAAeV,QAAf,CAAZ;AACA,yBAAKW,GAAL,GAAW,IAAX;AAhBuB;AAAA,2BAiBjBpB,IAjBiB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAA3B;AAmBAH,QAAQC,SAAR,CAAkBuB,QAAlB,8BAA6B,kBAAUrB,IAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AACrBC,yBADqB,GACb,KAAKA,KADQ;AAErBC,2BAFqB,GAEX;AACVoB,8BAAK,MADK;AAEVnB,gCAAOF,MAAMG,OAFH;AAGVC,+BAAMJ,MAAMK;AAHF,qBAFW;AAAA;AAAA,2BAORZ,UAAUa,YAAV,CAAuBL,OAAvB,CAPQ;;AAAA;AAOrBM,wBAPqB;AAQrBC,4BARqB,GAQV;AACXD,8BAAK;AACDE,sCAAS,EADR;AAEDE,wCAAWJ,KAAKK,UAFf;AAGDC,uCAAUN,KAAKO;;AAHd,yBADM;AAOXC,mCAAU;AAPC,qBARU;;AAiBzBpB,sBAAE2B,OAAF,CAAUf,KAAKG,IAAf,EAAoB,UAAUa,CAAV,EAAa;AAC7B,4BAAIC,UAAU;AACVC,sCAASF,EAAEE,QADD;AAEVC,yCAAaH,EAAEG,WAFL;AAGVC,yCAAYJ,EAAEK,OAAF,CAAUD,WAHZ;AAIVE,sCAASN,EAAEK,OAAF,CAAUE;AAJT,yBAAd;AAMAtB,iCAASD,IAAT,CAAcE,QAAd,CAAuBsB,IAAvB,CAA4BP,OAA5B;AACH,qBARD;AASA,yBAAKR,IAAL,GAAYC,KAAKC,SAAL,CAAeV,QAAf,CAAZ;AACA,yBAAKW,GAAL,GAAW,IAAX;AA3ByB;AAAA,2BA4BnBpB,IA5BmB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAA7B;AA8BAiC,OAAOC,OAAP,GAAiB,IAAIrC,OAAJ,EAAjB","file":"materal.js","sourcesContent":["/**\r\n * Created by yao on 2016/11/20.\r\n */\r\n/* global exports */\r\n\r\n\"use strict\";\r\nvar wechatApi = require('../../weixin').wechatApi;\r\nvar _ = require('lodash');\r\nvar Materal = function(){\r\n\r\n};\r\n\r\nMateral.prototype.imgList =function*(next) {\r\n    var query = this.query;\r\n    var options = {\r\n        offset:query.pageNum,\r\n        count:query.pageSize\r\n    };\r\n    var data = yield wechatApi.loadMaterial(options);\r\n    var backdata = {\r\n        data:{\r\n            dataList:data.item,\r\n            totalPages:data.item_count,\r\n            totalRows:data.total_count\r\n        },\r\n        isSuccess:true\r\n    };\r\n    this.body = JSON.stringify(backdata);\r\n    this.api = true;\r\n    yield next;\r\n};\r\nMateral.prototype.newsList = function*(next){\r\n    var query = this.query;\r\n    var options = {\r\n        type:'news',\r\n        offset:query.pageNum,\r\n        count:query.pageSize\r\n    };\r\n    var data = yield wechatApi.loadMaterial(options);\r\n    var backdata = {\r\n        data:{\r\n            dataList:[],\r\n            totalPages:data.item_count,\r\n            totalRows:data.total_count,\r\n\r\n        },\r\n        isSuccess:true\r\n    };\r\n    _.forEach(data.item,function (o) {\r\n        var article = {\r\n            media_id:o.media_id,\r\n            update_time :o.update_time,\r\n            create_time:o.content.create_time,\r\n            articles:o.content.news_item\r\n        };\r\n        backdata.data.dataList.push(article);\r\n    });\r\n    this.body = JSON.stringify(backdata);\r\n    this.api = true;\r\n    yield next;\r\n};\r\nmodule.exports = new Materal();"]}